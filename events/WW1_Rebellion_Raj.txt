add_namespace = ww1_rebellion_raj

# Malabar Rebellion
country_event = {
	id = ww1_rebellion_raj.1
	title = ww1_rebellion_raj.1.t
	desc = ww1_rebellion_raj.1.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	trigger = {
		tag = RAJ
		has_idea = RAJ_non_cooperation_movement
        has_country_flag = khilafat_movement_started
        NOT = { has_country_flag = fall_of_the_raj }
        date > 1921.8.19
	}
    immediate = {
		hidden_effect = {
			423 = { set_demilitarized_zone = yes }
			424 = { set_demilitarized_zone = yes }

			set_country_flag = malabar_rebellion_started

			set_country_flag = {
				flag = chekutty_murder_cooldown
				days = 31
				value = 1
			}
			set_country_flag = {
				flag = the_hindu_cooldown
				days = 60
				value = 1
			}
			set_country_flag = {
				flag = battle_of_pandikkad_cooldown
				days = 86
				value = 1
			}
			set_country_flag = {
				flag = american_newspapers_cooldown
				days = 109
				value = 1
			}

			set_variable = {
				var = malabar_rebellion_strength
				value = 60
			}
			set_variable = {
				var = malabar_rebellion_stab_var
				value = -0.001
			}
			multiply_variable = {
				var = malabar_rebellion_stab_var
				value = malabar_rebellion_strength
			}
			multiply_variable = {
				var = malabar_rebellion_stab_var
				value = 0.25
			}

			set_variable = {
				var = malabar_days_mission_timeout_var
				value = 0
			}
			set_variable_to_random = {
				var = malabar_days_mission_timeout_var
				min = 30
				max = 45
				integer = yes
			}
		}
    }
	option = {
		name = ww1_rebellion_raj.1.a
        activate_mission = RAJ_malabar_agitation_mission
		hidden_effect = {
			country_event = {
				id = ww1_rebellion_raj.2
				days = 5
			}
		}
	}
}

# Malayala Rajyam
country_event = {
	id = ww1_rebellion_raj.2
	title = ww1_rebellion_raj.2.t
	desc = ww1_rebellion_raj.2.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_rebellion_raj.2.a
		add_to_variable = {
			var = malabar_rebellion_strength
			value = 15
			tooltip = malabar_rebellion_strength_15
		}
		if = {
			limit = { check_variable = { malabar_rebellion_strength > 100 } }
			set_variable = {
				var = malabar_rebellion_strength
				value = 100
			}
		}
	}
}

# Chekutty Murder
country_event = {
	id = ww1_rebellion_raj.3
	title = ww1_rebellion_raj.3.t
	desc = ww1_rebellion_raj.3.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	trigger = {
		tag = RAJ
		has_country_flag = malabar_rebellion_started
		NOT = { has_country_flag = crushed_malabar_rebellion }
		NOT = { has_country_flag = chekutty_murder_cooldown }
	}
	option = {
		name = ww1_rebellion_raj.3.a
		if = {
			limit = {
				check_variable = { malabar_rebellion_strength < 96 }
			}
			add_to_variable = {
				var = malabar_rebellion_strength
				value = 5
				tooltip = malabar_rebellion_strength_5
			}
		}
	}
}

# The Hindu
country_event = {
	id = ww1_rebellion_raj.4
	title = ww1_rebellion_raj.4.t
	desc = ww1_rebellion_raj.4.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	trigger = {
		tag = RAJ
		has_country_flag = malabar_rebellion_started
		NOT = { has_country_flag = crushed_malabar_rebellion }
		NOT = { has_country_flag = the_hindu_cooldown }
	}
	option = {
		name = ww1_rebellion_raj.4.a
		if = {
			limit = {
				check_variable = { malabar_rebellion_strength < 96 }
			}
			add_to_variable = {
				var = malabar_rebellion_strength
				value = 5
				tooltip = malabar_rebellion_strength_5
			}
		}
	}
}

# Battle of Pandikkad
country_event = {
	id = ww1_rebellion_raj.5
	title = ww1_rebellion_raj.5.t
	desc = ww1_rebellion_raj.5.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	trigger = {
		tag = RAJ
		has_country_flag = malabar_rebellion_started
		NOT = { has_country_flag = crushed_malabar_rebellion }
		NOT = { has_country_flag = battle_of_pandikkad_cooldown }
	}
	option = {
		name = ww1_rebellion_raj.5.a
		if = {
			limit = {
				check_variable = { malabar_rebellion_strength < 96 }
			}
			add_to_variable = {
				var = malabar_rebellion_strength
				value = 5
				tooltip = malabar_rebellion_strength_5
			}
		}
	}
}

# Forced Conversions
country_event = {
	id = ww1_rebellion_raj.6
	title = ww1_rebellion_raj.6.t
	desc = ww1_rebellion_raj.6.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	trigger = {
		tag = RAJ
		has_country_flag = malabar_rebellion_started
		NOT = { has_country_flag = crushed_malabar_rebellion }
		NOT = { has_country_flag = american_newspapers_cooldown }
	}
	option = {
		name = ww1_rebellion_raj.6.a
		if = {
			limit = {
				check_variable = { malabar_rebellion_strength < 96 }
			}
			add_to_variable = {
				var = malabar_rebellion_strength
				value = 5
				tooltip = malabar_rebellion_strength_5
			}
		}
	}
}

# Malabar Rebellion Crushed
country_event = {
	id = ww1_rebellion_raj.7
	title = ww1_rebellion_raj.7.t
	desc = ww1_rebellion_raj.7.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_rebellion_raj.7.a
		add_stability = 0.05
		hidden_effect = {
			country_event = {
				id = ww1_rebellion_raj.8
				days = 30
			}
		}
	}
}

# Execution of Haji
country_event = {
	id = ww1_rebellion_raj.8
	title = ww1_rebellion_raj.8.t
	desc = ww1_rebellion_raj.8.d
	picture = GFX_report_malabar_rebellion
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_rebellion_raj.8.a
		add_political_power = 75
		add_stability = -0.05
		custom_effect_tooltip = RAJ_haji_fucking_dies
	}
	option = {
		name = ww1_rebellion_raj.8.b
		add_political_power = 25
		add_stability = -0.02
		custom_effect_tooltip = RAJ_haji_fucking_dies
		custom_effect_tooltip = RAJ_historical_choice
	}
	option = {
		name = ww1_rebellion_raj.8.c
		add_political_power = -25
		add_stability = 0.02
		custom_effect_tooltip = RAJ_haji_fucking_lives
	}
}