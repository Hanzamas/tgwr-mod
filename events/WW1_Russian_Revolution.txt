add_namespace = ww1_russian_revolution

# Revolution in Petrograd
country_event = {
	id = ww1_russian_revolution.1
	title = ww1_russian_revolution.1.t
	desc = {
		text = ww1_russian_revolution.1.d.a
		trigger = {
			NOT = {
				has_completed_focus = RUS_cabinet_of_public_trust
			}
		}
	}
	desc = {
		text = ww1_russian_revolution.1.d.b
		trigger = { 
			has_completed_focus = RUS_cabinet_of_public_trust
		}
	}
	picture = GFX_filler
	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_idea = RUS_june_third_political_system
						has_idea = RUS_broken_compromise
						has_idea = RUS_progressive_bloc
					}
				}
				remove_ideas = {
					RUS_june_third_political_system
					RUS_broken_compromise
					RUS_progressive_bloc
				}
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
			}
			set_popularities = {
				democratic = 52
				neutrality = 0
				fascism = 10
				communism = 38
			}
			set_country_flag = february_revolution
			promote_character = RUS_mikhail_rodzyanko
		}
	}
	# Tsar needs to immediately get to Petrograd 
	option = {
		name = ww1_russia.1.a
		hidden_effect = {
			country_event = {
				id = ww1_russian_revolution.2
				days = 3
			}
		}
	}
}

# Tsar confronted by Duma members
country_event = {
	id = ww1_russian_revolution.2
	title = ww1_russian_revolution.2.t
	desc = ww1_russian_revolution.2.d
	picture = GFX_filler
	fire_only_once = yes
	is_triggered_only = yes
	
	# Form the Provisional Government and abdicate in favour of Mikhail 
	option = {
		name = ww1_russia.2.a
		trigger = {
			NOT = {
				has_completed_focus = RUS_cabinet_of_public_trust
			}
		}
		hidden_effect = {
			promote_character = RUS_georgiy_lvov
			activate_advisor = RUS_alexander_guchkov
			activate_advisor = RUS_alexander_kerensky
			activate_advisor = RUS_pavel_milyukov
			RUS_mikhail_ii = {
				set_character_name = {
					name = RUS_mikhail_ii
				}
				add_country_leader_role = {
					country_leader = {
						ideology = semi_constitutional_monarchy
						traits = { controversy_over_legitimacy }
					}
				}
				promote_character = semi_constitutional_monarchy
			}
			country_event = {
				id = ww1_russian_revolution.3
				days = 1
			}
		}
	}
	# Abdicate in favour of Alexei with Mikhail as regent and grant full powers to the State Duma
	option = {
		name = ww1_russia.2.b
		trigger = {
			has_completed_focus = RUS_cabinet_of_public_trust
		}
		hidden_effect = {
			RUS_mikhail_ii = {
				set_character_name = {
					name = RUS_mikhail_regent
				}
				add_country_leader_role = {
					country_leader = {
						ideology = semi_constitutional_monarchy
						traits = { controversy_over_legitimacy }
					}
				}
				promote_character = semi_constitutional_monarchy
			}
			promote_character = RUS_georgiy_lvov
			country_event = {
				id = ww1_russian_revolution.4
				days = 7
			}
		}
	}
}

# Mikhail refused to accept the throne
country_event = {
	id = ww1_russian_revolution.3
	title = ww1_russian_revolution.3.t
	desc = ww1_russian_revolution.3.d
	picture = GFX_filler
	fire_only_once = yes
	is_triggered_only = yes

	# What was he thinking?!
	option = {
		name = ww1_russia.3.a
		hidden_effect = {
			RUS_mikhail_ii = {
				remove_country_leader_role = {
					ideology = semi_constitutional_monarchy
				}
				remove_any_country_role_from_character = yes
			}
			set_cosmetic_tag = RUS_provisional_government
			country_event = {
				id = ww1_russian_revolution.4
				days = 6
			}
		}
	}
}

# Last order of Nicholas
country_event = {
	id = ww1_russian_revolution.4
	title = ww1_russian_revolution.4.t
	desc = {
		text = ww1_russian_revolution.4.d.a
		trigger = {
			NOT = {
				has_completed_focus = RUS_cabinet_of_public_trust
			}
		}
	}
	desc = {
		text = ww1_russian_revolution.4.d.b
		trigger = { 
			has_completed_focus = RUS_cabinet_of_public_trust
		}
	}
	picture = GFX_filler
	fire_only_once = yes
	is_triggered_only = yes

	# Let's renounce the old world
	option = {
		name = ww1_russia.4.a
		trigger = {
			NOT = {
				has_completed_focus = RUS_cabinet_of_public_trust
			}
		}
		add_stability = 0.025
		add_war_support = 0.025
	}
	# War to the bitter end
	option = {
		name = ww1_russia.4.b
		trigger = { 
			has_completed_focus = RUS_cabinet_of_public_trust
		}
		add_stability = 0.025
		add_war_support = 0.025
	}
}