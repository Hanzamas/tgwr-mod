add_namespace = ww1_nejd

# Demands southern Kuwait
country_event = {
	id = ww1_nejd.1
	title = ww1_nejd.1.t
	desc = ww1_nejd.1.d
	picture = GFX_report_event_generic_defensive_preparations
	is_triggered_only = yes
	option = {
		name = ww1_nejd.1.a
		if = {
			limit = {
				OR = {
					is_subject = yes
					is_in_faction = yes
				}
			}
			set_country_flag = kuwait_najd_war
			start_border_war = {
				change_state_after_war = no
				attacker = {
					state = 292
					num_provinces = 2
					on_win = ww1_nejd.2
					on_lose = ww1_nejd.3
					on_cancel = ww1_nejd.4
				}
				defender = {
					state = 905
					num_provinces = 1
					on_win = ww1_nejd.3
					on_lose = ww1_nejd.2
					on_cancel = ww1_nejd.4
				}
			}
		}
		else = {
			FROM = {
				create_wargoal = {
					target = ROOT
					type = take_claimed_state
				}
			}
		}
		ai_chance = {
			base = 30
			modifier = {
				add = -15
				has_opinion = {
					target = FROM
					value < 0
				}
			}
			modifier = {
				add = -15
				strength_ratio = {
					tag = FROM
					ratio > 0.5
				}
			}
		}
	}
	option = {
		name = ww1_nejd.1.b
		trigger = {
			OR = {
				is_subject = no
				is_subject_of = FROM
			}
		}
		every_owned_state = {
			limit = {
				OR = {
					state = 904
					state = 905
				}
			}
			remove_claim_by = FROM
			transfer_state_to = FROM
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio > 0.5
				}
			}
		}
	}
}

# Nejd won the war
country_event = {
	id = ww1_nejd.2
	title = ww1_nejd.2.t
	desc = ww1_nejd.2.d
	picture = GFX_report_event_generic_sign_treaty1
	is_triggered_only = yes
	option = {
		name = ww1_nejd.2.a
		trigger = { original_tag = SAU }
		every_state = {
			limit = {
				OWNER = {
					has_country_flag = kuwait_najd_war
				}
				OR = {
					state = 904
					state = 905
				}
			}
			transfer_state_to = ROOT
		}
	}
	option = {
		name = ww1_nejd.2.b
		trigger = { NOT = { original_tag = SAU } }
		effect_tooltip = {
			every_owned_state = {
				limit = {
					OR = {
						state = 904
						state = 905
					}
				}
				transfer_state_to = SAU
			}
		}
		add_political_power = -50
	}
}

# Nejd lost the war
country_event = {
	id = ww1_nejd.3
	title = ww1_nejd.2.t
	desc = ww1_nejd.3.d
	picture = GFX_report_event_generic_sign_treaty1
	is_triggered_only = yes
	option = {
		name = ww1_nejd.2.b
		trigger = { original_tag = SAU }
		add_war_support = -0.10
	}
	option = {
		name = ww1_nejd.2.a
		trigger = { NOT = { original_tag = SAU } }
		if = {
			limit = {
				904 = { is_core_of = ROOT }
			}
			add_war_support = 0.10
			add_political_power = 200
			else = {
				add_political_power = 50
			}
		}
	}
}

# No more kuwaiti war
country_event = {
	id = ww1_nejd.4
	title = ww1_nejd.2.t
	desc = ww1_nejd.4.d
	picture = GFX_report_event_generic_army
	is_triggered_only = yes
	option = {
		name = ww1_nejd.4.a
	}
}

# The Ottomans Decision over Al-Hasa
country_event = {
	id = ww1_nejd.5
	title = ww1_nejd.5.t
	desc = ww1_nejd.5.d
	picture = GFX_report_event_tur_turkish_soldiers
	trigger = {
		tag = TUR
		has_war = no
		is_subject = no
		has_active_mission = SAU_ottoman_saudi_treaty_timer
		date < 1914.5.1
		NOT = {
			has_idea = idea_army_restrictions
			has_global_flag = ottoman_saudi_in_progress
		}
	}
	fire_only_once = yes
	mean_time_to_happen = { days = 70 }
	option = {
		# We'll demand them to return there
		custom_effect_tooltip = historical_tt
		name = ww1_nejd.5.a
		hidden_effect = {
			SAU = {
				country_event = {
					id = ww1_nejd.6
					days = 20
				}
			}
		}
		custom_effect_tooltip = agree_effect_tooltip
		effect_tooltip = {
			every_state = {
				limit = {
					is_owned_by = SAU
					is_coastal = yes
				}
				transfer_state_to = FROM
			}
			puppet = SAU
		}
		custom_effect_tooltip = disagree_effect_tooltip
		effect_tooltip = {
			create_wargoal = {
				target = SAU
				type = puppet_wargoal_focus
			}
		}
	}
	option = {
		# We'll just give up...
		name = ww1_nejd.5.b
		remove_state_claim = 804
		set_global_flag = ottoman_gave_up_alhasa
		ai_chance = { base = 0 }
	}
}

# The Ottomans Demand to Return Al-Hasa
country_event = {
	id = ww1_nejd.6
	title = ww1_nejd.6.t
	desc = ww1_nejd.6.d
	picture = GFX_report_event_tur_turkish_soldiers
	is_triggered_only = yes
	trigger = {
		has_active_mission = SAU_ottoman_saudi_treaty_timer
	}
	option = {
		# Ask Brits to help
		name = ww1_nejd.6.a
		trigger = {
			ENG = {
				exists = yes
				NOT = {
					has_country_flag = great_war_loser
					has_idea = idea_army_restrictions
					has_war_with = ROOT
					has_war_with = FROM
					is_in_faction_with = FROM
					has_government = communism
				}
				658 = { is_owned_or_subject_PREV_trigger = yes } #British Gulf
			}
		}
		custom_effect_tooltip = historical_tt
		ENG = {
			country_event = {
				id = ww1_nejd.7
				days = 30
			}
		}
		custom_effect_tooltip = agree_effect_tooltip
		effect_tooltip = {
			ENG = {
				puppet = ROOT
			}
		}
	}
	option = {
		# We'll just give up...
		name = ww1_nejd.6.b
		every_owned_state = {
			limit = {
				is_coastal = yes
			}
			transfer_state_to = FROM
		}
		effect_tooltip = {
			FROM = { puppet = ROOT }
		}
		hidden_effect = {
			get_current_government_type = yes
			FROM = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_tgwr_ottoman_emirate
				}
			}
			restore_previous_government_type = yes
			add_ideas = TUR_wavering_ottoman_influence
		}
		ai_chance = { base = 0 }
	}
	option = {
		# Bruh
		name = ww1_nejd.6.c
		FROM = {
			hidden_effect = {
				every_state = {
					limit = {
						is_coastal = yes
						is_owned_by = ROOT
					}
					add_claim_by = PREV
				}
			}
			create_wargoal = {
				target = ROOT
				type = puppet_wargoal_focus
			}
		}
		ai_chance = { base = 0 }
	}
}

# The Saudis requests help over al-hasa
country_event = {
	id = ww1_nejd.7
	title = ww1_nejd.7.t
	desc = ww1_nejd.7.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		has_active_mission = SAU_ottoman_saudi_treaty_timer
	}
	option = {
		# Take a neutral stance with prioritizing British interest first.
		name = ww1_nejd.7.a
		custom_effect_tooltip = historical_tt
		FROM = {
			country_event = {
				id = ww1_nejd.8
				days = 30
			}
		}
		TUR = {
			country_event = {
				id = ww1_nejd.8
				days = 30
			}
		}
	}
	option = {
		# Ignore
		name = ww1_nejd.7.b
		FROM = {
			country_event = {
				id = ww1_nejd.9
				days = 30
			}
		}
		ai_chance = { base = 0 }
	}
	option = {
		# Accept them as protectorate
		name = ww1_nejd.7.c
		FROM = {
			country_event = {
				id = ww1_nejd.10
				days = 30
			}
		}
		TUR = {
			country_event = {
				id = ww1_nejd.10
				days = 30
			}
		}
		ai_chance = { base = 0 }
	}
}

# Britain asks for no war in the Gulf
country_event = {
	id = ww1_nejd.8
	title = ww1_nejd.8.t
	desc = ww1_nejd.8.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		has_active_mission = SAU_ottoman_saudi_treaty_timer
	}
	immediate = {
		hidden_effect = {
			set_global_flag = ottoman_saudi_in_progress
		}
	}
	option = {
		name = ww1_nejd.8.a
		# Make reasonable demands of the Saudis.
		trigger = { original_tag = TUR }
		custom_effect_tooltip = ww1_nejd.8.tt
	}
	option = {
		name = ww1_nejd.8.b
		# Saud notifies
		trigger = { original_tag = SAU }
		add_political_power = -25
		custom_effect_tooltip = ww1_nejd.8.tt
	}
}

# Britain Ignored the Saudis
country_event = {
	id = ww1_nejd.9
	title = ww1_nejd.9.t
	desc = ww1_nejd.9.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		has_active_mission = SAU_ottoman_saudi_treaty_timer
	}
	option = {
		# We'll just give up...
		name = ww1_nejd.6.b
		every_owned_state = {
			limit = {
				is_coastal = yes
			}
			transfer_state_to = TUR
		}
		effect_tooltip = {
			TUR = { puppet = ROOT }
		}
		hidden_effect = {
			get_current_government_type = yes
			TUR = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_tgwr_ottoman_emirate
				}
			}
			restore_previous_government_type = yes
			add_ideas = TUR_wavering_ottoman_influence
		}
	}
	option = {
		# Bruh
		name = ww1_nejd.6.c
		TUR = {
			hidden_effect = {
				every_state = {
					limit = {
						is_coastal = yes
						is_owned_by = ROOT
					}
					add_claim_by = PREV
				}
			}
			create_wargoal = {
				target = ROOT
				type = puppet_wargoal_focus
			}
		}
		ai_chance = { base = 0 }
	}
}

# Britain Protects the Saudis
country_event = {
	id = ww1_nejd.10
	title = ww1_nejd.10.t
	desc = ww1_nejd.10.d
	picture = GFX_report_event_generic_conference
	is_triggered_only = yes
	trigger = {
		has_active_mission = SAU_ottoman_saudi_treaty_timer
	}
	option = {
		# British Protection
		name = ww1_nejd.10.a
		trigger = { original_tag = SAU }
		effect_tooltip = {
			FROM = { puppet = ROOT }
		}
		hidden_effect = {
			get_current_government_type = yes
			FROM = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_tgwr_protectorate
				}
				if = {
					limit = {
						has_subject_autonomy_feature = yes
					}
					set_country_flag = protectorate
					else = {
						add_ideas = protectorate
					}
				}
			}
			restore_previous_government_type = yes
		}
	}
	option = {
		# Turkish notifies
		name = ww1_nejd.10.b
		trigger = { original_tag = TUR }
		effect_tooltip = {
			FROM = { puppet = SAU }
		}
	}
}

# Saud can revoke the treaty in case of war
country_event = {
	id = ww1_nejd.11
	title = ww1_nejd.11.t
	desc = ww1_nejd.11.d
	picture = GFX_report_event_tur_turkish_soldiers
	trigger = {
		tag = SAU
		TUR = {
			has_subject = ROOT
			has_war_with = ENG
		}
	}
	fire_only_once = yes
	option = {
		name = ww1_nejd.11.a
		OVERLORD = { end_puppet = ROOT }
		if = {
			limit = { is_in_faction = yes }
			leave_faction = yes
		}
		OVERLORD = {
			every_enemy_country = {
				limit = {
					has_war_with = ROOT
				}
				white_peace = ROOT
			}
			country_event = ww1_nejd.12
		}
	}
}

# Saud revoked the treaty
country_event = {
	id = ww1_nejd.12
	title = ww1_nejd.12.t
	desc = ww1_nejd.12.d
	picture = GFX_report_event_tur_turkish_soldiers
	is_triggered_only = yes
	option = {
		name = ww1_nejd.12.a
		add_political_power = -25
		add_opinion_modifier = {
			target = FROM
			modifier = HOI4TGW_Opinion_alliance_malus
		}
	}
}