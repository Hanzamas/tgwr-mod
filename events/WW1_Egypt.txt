add_namespace = ww1_egypt
add_namespace = egypt_rework

# EGYPTIAN REVOLUTION
#####################
country_event = {
	id = ww1_egypt.1
	title = interwar_news.5.t
	desc = interwar_news.5.d
	picture = GFX_report_event_india_protests

	fire_only_once = yes

	trigger = {
		tag = EGY
		has_global_flag = interbellum
		has_war = no
		is_subject_of = ENG
		NOT = {	
			has_global_flag = egyptian_revolution 
			has_government = democratic
			has_government = fascism
		}
		date > 1919.10.1
		ENG = {
			has_war = no
			NOT = {
				has_country_flag = great_war_loser
			}
		}	
	}
	
	mean_time_to_happen = {
			days = 5
		}

	immediate = {
		set_global_flag = egyptian_revolution
	}

	option = {
		name = ww1_egypt.1.a
		ENG = { 
			country_event = { id = ww1_egypt.4 days = 1 hours = 1 } 
			hidden_effect = {
				unlock_national_focus = ENG_control_under_egypt
			}
		}
		news_event = { id = interwar_news.5 days = 1 }
		add_autonomy_score = {
			value = 50
		}
		add_war_support = -0.01
		every_owned_state = {
			limit = {
				OR = {
					state = 446
					state = 447
				}
			}
			set_demilitarized_zone = yes
		}
		hidden_effect = {
			TUR = {
				country_event = {
					id = ww1_england.82
				}
			}
		}	
	}
}
# British Coup
###############
country_event = {
	id = ww1_egypt.2
	title = ww1_egypt.2.t
	desc = ww1_egypt.2.d
	picture = GFX_report_event_india_protests

	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = ww1_egypt.2.a
		promote_character = EGY_hussein_kamel
	}
}
country_event = {
	id = ww1_egypt.3
	title = ww1_egypt.3.t
	desc = ww1_egypt.3.d
	picture = GFX_report_event_saf_civil_war

	fire_only_once = yes
	trigger = {
		original_tag = EGY
		has_country_leader = {
			character = EGY_hussein_kamel
		}
		date > 1917.10.1
	}
	mean_time_to_happen = { days = 8 }
	
	option = {
		name = ww1_egypt.2.a
		kill_country_leader = yes
		promote_character = EGY_egyptian_government
		if = {
			limit = {
				has_completed_focus = EGY_khedive_must_go
			}
			complete_national_focus = EGY_death_of_a_sultan
		}
	}
}
# EGYPTIAN REVOLUTION - UK RESPONCE
#####################
country_event = {
	id = ww1_egypt.4
	title = interwar_news.5.t
	desc = ww1_egypt.4.d
	picture = GFX_report_event_india_protests

	is_triggered_only = yes
	fire_only_once = yes


	option = {
		name = ww1_egypt.4.a
		add_political_power = -50
		add_command_power = -50
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				ENG_edmund_allenby = { is_unit_leader = yes is_country_leader = no }
			}
			ENG_edmund_allenby = {
				set_nationality = EGY
				if = {
					limit = {
						is_field_marshal = no									
					}
					promote_leader = yes
				}
			}
		}
		add_manpower = -29
		AST = {
			add_manpower = -1
		}
		unlock_decision_tooltip = ENG_recognize_egyptian_independence
		set_global_flag = egyptian_revolution_suppressed
		hidden_effect = {
			every_owned_state = {
				limit = {
					OR = {
						state = 446
						state = 447
					}
				}
				set_demilitarized_zone = no
			}
		}
	}
	option = {
		name = ww1_egypt.4.b
		add_political_power = 50
		EGY = {
			#set_cosmetic_tag = EGY_kingdom
			if = {
				limit = {
					has_government = neutrality
				}
				set_country_leader_ideology = autocracy
			}
			add_popularity = {
				ideology = democratic
				popularity = 0.3
			}
		}
		every_owned_state = {
			limit = {
				NOT = {
					state = 447
				}	
				OR = {
					is_core_of = EGY
					is_core_of = SUD
					is_claimed_by = EGY
				}
			}
			transfer_state_to = EGY
		}
		hidden_effect = {
			every_owned_state = {
				limit = {
					OR = {
						state = 446
						state = 447
					}
				}
				set_demilitarized_zone = no
			}
			set_global_flag = egyptian_revolution_suppressed
		}
		ai_chance = {
			factor = 0
		}
	}
}
# QUESTION FOR SUEZ CANAL OWNERSHIP
######################################
country_event = {
	id = ww1_egypt.5
	title = ww1_egypt.5.t
	desc = ww1_egypt.5.d
	picture = GFX_report_event_german_troops
	fire_only_once = yes
	trigger = {
		original_tag = EGY
		has_global_flag = interbellum
		is_subject = no
		has_war = no
		owns_state = 447
		NOT = {
			has_global_flag = ottoman_egypt_guaranteed
			has_country_flag = great_war_winner
		}
		TUR = {
			is_neighbor_of = PREV
			has_country_flag = great_war_winner
			owns_state = 454
			NOT = { has_country_flag = ottomans_hold_cairo_and_alexandria }
		}
	}
	mean_time_to_happen = { days = 30 }

	option = {
		name = ww1_egypt.5.a

		hidden_effect = {
			TUR = {
				if = {
					limit = {
						has_country_flag = great_war_winner
					}

					country_event = {
						id = ww1_egypt.7
						random = 3
					}
				}
			}
		}

		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				has_opinion = {
					target = GER
					value > 80
				}
			}
		}
	}
	option = {
		name = ww1_egypt.5.b

		GER = { country_event = ww1_egypt.6 }

		ai_chance = {
			base = 0
			modifier = {
				add = 200
				has_opinion = {
					target = GER
					value > 80
				}
			}
			modifier = {
				add = 100
				has_opinion = {
					target = GER
					value > 50
				}
			}
			modifier = {
				add = 50
				has_opinion = {
					target = GER
					value > 35
				}
			}
			modifier = {
				add = 10
				has_opinion = {
					target = GER
					value > 20
				}
			}
		}
	}
}

# GERMAN PROTECTION ON SUEZ CANAL
######################################
country_event = {
	id = ww1_egypt.6
	title = ww1_egypt.6.t
	desc = ww1_egypt.6.d
	picture = GFX_report_event_german_troops
	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = ww1_egypt.6.a
		transfer_state = 447
		give_guarantee = FROM
		add_opinion_modifier = {
			target = FROM
			modifier = german_protection_of_suez_canal
		}
		diplomatic_relation = {
			country = FROM
			relation = non_aggression_pact
			active = yes
		}
		FROM = {
			diplomatic_relation = {
				country = PREV
				relation = docking_rights
				active = yes
			}
			add_opinion_modifier = {
				target = PREV
				modifier = german_protection_of_suez_canal
			}
		}
		news_event = ww1_egypt.10
	}
}

# DO OTTOMAN SEIZES SUEZ CANAL?
######################################
country_event = {
	id = ww1_egypt.7
	title = ww1_egypt.7.t
	desc = ww1_egypt.7.d
	picture = GFX_report_event_german_troops
	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = ww1_egypt.7.a

		if = {
			limit = {
				NOT = { owns_state = 453 }
			}
			transfer_state = 453

			hidden_effect = { set_global_flag = egypt_owns_sinai_interbellum }
		}

		start_border_war = {
			change_state_after_war = no
			attacker = {
				state = 453
				num_provinces = 3
				on_win = ww1_egypt.8
				on_lose = ww1_egypt.9
				on_cancel = ww1_egypt.9
			}

			defender = {
				state = 447
				num_provinces = 2
				on_win = ww1_egypt.9
				on_lose = ww1_egypt.8
				on_cancel = ww1_egypt.9
			}
		}

		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				has_opinion = {
					target = EGY
					value > 50
				}
			}
		}
	}
	option = {
		name = ww1_egypt.7.b
		
		remove_state_claim = 447

		ai_chance = {
			base = 0
			modifier = {
				add = 100
				has_opinion = {
					target = EGY
					value > 50
				}
			}
		}
	}
}

# OTTOMAN SEIZES SUEZ CANAL
######################################
news_event = {
	id = ww1_egypt.8
	title = ww1_egypt.8.t
	desc = ww1_egypt.8.d
	picture = GFX_news_event_038
	major = yes
	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				tag = TUR
			}
			transfer_state = 447
			add_war_support = 0.03
		}
		if = {
			limit = {
				tag = EGY
			}
			add_war_support = -0.03
		}
	}

	option = {
		name = ww1_egypt.8.a
		trigger = {
			tag = TUR
		}
	}
	option = {
		name = ww1_egypt.8.b
		trigger = {
			tag = EGY
		}
	}
	option = {
		name = ww1_egypt.8.c
		trigger = {
			NOT = {
				tag = TUR
				tag = EGY
			}
		}
	}
}

# EGYPT HOLDS SUEZ CANAL
######################################
news_event = {
	id = ww1_egypt.9
	title = ww1_egypt.9.t
	desc = ww1_egypt.9.d
	picture = GFX_news_event_038
	major = yes
	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				tag = TUR
			}
			add_war_support = -0.03
		}
		if = {
			limit = {
				tag = EGY
			}
			add_war_support = 0.03
			
			hidden_effect = {
				if = {
					limit = {
						has_global_flag = egypt_owns_sinai_interbellum
					}
					transfer_state = 453
				}
			}
		}
	}

	option = {
		name = ww1_egypt.9.a
		trigger = {
			tag = TUR
		}
	}
	option = {
		name = ww1_egypt.9.b
		trigger = {
			tag = EGY
		}
	}
	option = {
		name = ww1_egypt.9.c
		trigger = {
			NOT = {
				tag = TUR
				tag = EGY
			}
		}
	}
}

# German Suez
news_event = {
	id = ww1_egypt.10
	title = ww1_egypt.10.t
	desc = ww1_egypt.10.d
	picture = GFX_news_event_038
	major = yes
	is_triggered_only = yes
	option = {
		name = ww1_egypt.10.a
		trigger = {
			NOT = {
				tag = GER
				is_subject_of = GER
				is_in_faction_with = GER
				tag = EGY
				is_subject_of = EGY
				is_in_faction_with = EGY
			}
		}
	}
	option = {
		name = ww1_egypt.10.b
		trigger = {
			OR = {
				tag = GER
				is_subject_of = GER
				is_in_faction_with = GER
				tag = EGY
				is_subject_of = EGY
				is_in_faction_with = EGY
			}
		}
	}
}

########### NEW CONTENT ##############

#Egypt asks for control of the Suez
country_event = {
	id = egypt_rework.1
	title = egypt_rework.1.t
	desc = egypt_rework.1.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	#yes
	option = {
		name = egypt_rework.1.a
		add_political_power = 20
		EGY = {
			transfer_state = 447
			country_event = { id = egypt_rework.2 hours = 6 }
		}
		ai_chance = {
			base = 100
		}
	}
	#hell no
	option = {
		name = egypt_rework.1.b
		add_political_power = -15
		EGY = { country_event = { id = egypt_rework.3 hours = 7 } }
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				has_opinion = {
					target = EGY
					value < -25
				}
			}
		}
	}
}
#she said yes!
country_event = {
	id = egypt_rework.2
	title = egypt_rework.2.t
	desc= egypt_rework.2.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = egypt_rework.2.a
		effect_tooltip = { transfer_state = 447 }
	}
}
#it's joever pharaohcels...
country_event = {
	id = egypt_rework.3
	title = egypt_rework.3.t
	desc = egypt_rework.3.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = egypt_rework.3.a
		add_popularity = {
			ideology = fascism
			popularity = -0.075
		}
	}
}

#THE CAIRO MASSACRE
news_event = {
	id = egypt_rework.4
	title = egypt_rework.4.t
	desc = egypt_rework.4.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = egypt_rework.4.a
		trigger = { 
			NOT = { OR = { original_tag = EGY original_tag = ENG } } 
		}
	}
	option = {
		name = egypt_rework.4.b
		trigger = {
			original_tag = ENG
		}
	}
	option = {
		name = egypt_rework.4.c
		trigger = {
			original_tag = EGY
		}
		if = {
			limit = {
				has_completed_focus = EGY_preempt_revolution
			}
			country_event = {
				id = egypt_rework.5
				days = 2
				hours = 6
			}
		}
	}
}
#Egyptian revolution
country_event = {
	id = egypt_rework.5
	title = egypt_rework.5.t
	desc = egypt_rework.5.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = egypt_rework.5.a
		set_cosmetic_tag = EGY_dominion_of_egypt
		start_civil_war = {
		    ideology = democratic
		    size = 0.4
		    army_ratio = 0.4
		    navy_ratio = 0.1
		    air_ratio = 0
		    keep_unit_leaders_trigger = {
	        	has_trait = trait_royalist
    		}
		}
		hidden_effect = {
			every_country = {
				limit = {
					original_tag = EGY
					has_government = democratic
				}
				set_country_flag = egyptian_rebels
				load_focus_tree = egypt
				unlock_national_focus = EGY_fires_of_revolution
				unlock_national_focus = EGY_smuggle_the_exiles
				unlock_national_focus = EGY_win_over_copts
				unlock_national_focus = EGY_republican_nationalism
				unlock_national_focus = EGY_enlist_german_support
				unlock_national_focus = EGY_stage_an_incident
			}
		}
	}
}
#Egypt asks for Sudan
country_event = {
	id = egypt_rework.6
	title = egypt_rework.6.t
	desc = egypt_rework.6.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	#sure
	option = {
		name = egypt_rework.6.a
		EGY = {
			transfer_state = 551
		}
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				OR = {
					has_completed_focus = ENG_africa_regionalism
					has_completed_focus = ENG_the_radical
				}
			}
		}
	}
	#you can have it all
	option = {
		name = egypt_rework.6.b
		EGY = {
			transfer_state = 551
			transfer_state = 549
			if = {
				limit = {
					ENG = {
						owns_state = 449
					}
				}
				transfer_state = 449
			}
		}
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_completed_focus = ENG_africa_regionalism
					has_completed_focus = ENG_the_radical
				}
			}
		}
	}
	#hell no
	option = {
		name = egypt_rework.6.c
		add_political_power = -15
		ai_chance = {
			base = 0
		}
	}
}
#Muslims protest against christianisation
country_event = {
	id = egypt_rework.7
	title = egypt_rework.7.t
	desc = egypt_rework.7.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	#kill em all!
	option = {
		name = egypt_rework.7.a
		add_manpower = -127
		add_stability = -0.15
	}
	#we must be kind
	option = {
		name = egypt_rework.7.b
		add_political_power = -200
	}
}
#UK give Palestine to Egypt?
country_event = {
	id = egypt_rework.8
	title = egypt_rework.8.t
	desc = egypt_rework.8.d
	#picture =
	trigger = {
		original_tag = ENG
		owns_state = 856
		owns_state = 454
		owns_state = 858
		EGY = { 
			is_subject_of = ENG 
			has_completed_focus = EGY_invite_zionists
		}
	}
	fire_only_once = yes
	#no
	option = {
		name = egypt_rework.8.a
		ai_chance = {
			base = 0
		}
	}
	#yeah why not
	option = {
		name = egypt_rework.8.b
		ai_chance = {
			base = 100
		}
		EGY = {
			transfer_state = 856
			transfer_state = 454
			transfer_state = 858
		}
	}
}
#EGY form Israel?
country_event = {
	id = egypt_rework.9
	title = egypt_rework.9.t
	desc = egypt_rework.9.d
	#picture =
	trigger = {
		original_tag = EGY
		has_completed_focus = EGY_invite_zionists
		owns_state = 856
		owns_state = 454
		owns_state = 858
	}
	fire_only_once = yes
	#yes
	option = {
		name = egypt_rework.9.a
		ISR = {
			transfer_state = 856
			transfer_state = 454
			transfer_state = 858
			add_state_claim = 856
			add_state_core = 454
			add_state_claim = 858
		}
		puppet = ISR
		ai_chance = {
			base = 0
		}
	}
	#no, I don't think so
	option = {
		name = egypt_rework.9.b
		ai_chance = {
			base = 100
		}
		ISR = {
			add_state_core = 454
		}
		add_stability = -0.01
	}
}
#RUS gets opportunity to send a unit leader to EGY
country_event = {
	id = egypt_rework.10
	title = egypt_rework.10.t
	desc = egypt_rework.10.d
	#picture =
	is_triggered_only = yes
	fire_only_once = yes
	#nah we good
	option = {
		name = egypt_rework.10.a
		add_political_power = 10
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				is_historical_focus_on = no
			}
		}
	}
	#a smart idea to fight the Turk
	option = {
		name = egypt_rework.10.b
		add_political_power = 15
		RUS_vladimir_liakhov = {
			set_nationality = EGY
		}
		EGY = {
			RUS_vladimir_liakhov = {
				unit_leader_event = {
					id = egypt_rework.11
				}
			}
		}
		ai_chance = {
			base = 1
			modifier = {
				factor = 100
				is_historical_focus_on = no
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}
#EGY notified of Russian general's arrival
unit_leader_event = {
	id = egypt_rework.11
	title = egypt_rework.11.t
	desc = egypt_rework.11.d
	is_triggered_only = yes
	fire_only_once = yes
	#welcome aboard!
	option = {
		name = egypt_rework.11.a
		add_political_power = 5
		RUS_vladimir_liakhov = {
			add_country_leader_trait = trait_royalist
		}
	}
}

#declaration of independence under Kemal
country_event = {
		id = egypt_rework.12
		title = egypt_rework.12.t
		desc = egypt_rework.12.d
		#picture =
		is_triggered_only = yes
		fire_only_once = yes
		#let them go
		option = {
			ai_chance = {
				base = 50
				modifier = {
					factor = 100
					has_global_flag = kis_war
					NOT = {
						has_country_flag = great_war_winner
						has_country_flag = great_war_loser
					}
				}
			}
			name = egypt_rework.12.a
			set_autonomy = {
			    target = EGY
			    autonomy_state = autonomy_free
			    end_wars = no
			    end_civil_wars = no
			}
			add_political_power = -200
			give_military_access = EGY
			EGY = { give_military_access = ENG }
		}
		#we will fight to keep them british!
		option = {
			ai_chance = {
				base = 50
				modifier = {
					factor = 0
					has_global_flag = kis_war
					NOT = {
						has_country_flag = great_war_winner
						has_country_flag = great_war_loser
					}
				}
			}
			name = egypt_rework.12.b
			set_autonomy = {
			    target = EGY
			    autonomy_state = autonomy_free
			    end_wars = no
			    end_civil_wars = no
			}
			declare_war_on = {
    			target = EGY
			    type = annex_everything
			}
		}
}